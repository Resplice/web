<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=1, height=1, initial-scale=1.0, user-scalable=no" />
		<meta name="robots" content="noindex" />
	</head>
	<script>
		window.addEventListener('message', (event) => {
			console.log(event)
			// TODO: Check event.origin
			// if (event.origin !== 'https://auth.resplice.com') {
			// 	return
			// }

			const request = indexedDB.open('RESPLICE_CACHE')

			request.onsuccess = () => {
				const txn = request.result.transaction('context', 'readwrite')
				txn.objectStore('context').put(event.data, 1)
			}
			request.onerror = (e) => {
				console.error(e)
			}
			request.onupgradeneeded = () => {
				const db = request.result
				db.deleteObjectStore('context')
				db.createObjectStore('context', { autoIncrement: true })
			}
		})
	</script>
</html>
